<% @page_specific_scripts_js = ["parser", "vendors/prototip/prototip"] %>
<% @page_specific_scripts_css = ["prototip/prototip"] %>

<div id="doc_options" class="doc_options loading">
  <span>/<%= link_to @tag.name, '/#%i' % @tag.id %>/<input id="document_name" value="<%=@document.name%>"></input></span>
  <button id="review_button" style="float:right">Review</button>
  <button id="save_button" style="float:right;">Saved</button>
</div>

<div id="editor_container">
  <textarea id="editor" name="editor" style="display:none"><%=@document.html%></textarea>
</div>

<div id="right_rail" class="" style="display:none">
  <table class="align_bottom" valign="bottom"><tr><td id="cards" valign="bottom">
    <!--<div class="card card_active rounded_border"><input type="checkbox" class="card_activation" />truncated test</div>
    <div class="card_focus card rounded_border">
      <input type="checkbox" class="card_activation" />
      <div class="card_front">front</div>
      <div class="card_back">back and probablyaf sfkljasldk jfasldjfl;aksdjflsjdfsj flsjf lsk</div>
    </div>-->
  </td></tr></table>
</div>

<!-- document vars -->
<div id="document_id" style="display:none;"><%=@document.id%></div>
<div id="line_ids" style="display:none;"><%=@line_ids%></div>
<div id="new_doc" style="display:none;"><%=@new_doc%></div>
<div id="doc_count" style="display:none;"><%=@doc_count%></div>

<%= javascript_include_tag ["vendors/tiny_mce/tiny_mce"], :cache => false %>
<script type="text/javascript">
tinyMCE.init({
  mode : "textareas",
  theme : "advanced",
  plugins : "emotions,spellchecker,insertdatetime,preview,lists",

  // Theme options - button# indicated the row# only
  theme_advanced_buttons1 : "bold,italic,underline,|,justifyleft,justifycenter,justifyright,fontselect,fontsizeselect,formatselect",
  theme_advanced_buttons2 : "cut,copy,paste,|,bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,image,|,preview,|,forecolor,backcolor",
  theme_advanced_buttons3 : "insertdate,inserttime,|,spellchecker,removeformat,|,sub,sup,|,charmap,emotions",
  theme_advanced_toolbar_location : "top",
  theme_advanced_toolbar_align : "left",
  theme_advanced_resizing : true,

  // Drop lists for link/image/media/template dialogs
  template_external_list_url : "/javasripts/vendors/tinymce/template_list.js",
  external_link_list_url : "/javasripts/vendors/tinymce/link_list.js",
  external_image_list_url : "/javasripts/vendors/tinymce/image_list.js",
  media_external_list_url : "/javasripts/vendors/tinymce/media_list.js",

  content_css : "/stylesheets/documents/edit_contents.css",

  onpageload : function() {doc.onEditorLoaded()},

  setup : function(ed) {
    ed.onKeyDown.add(function(ed, e) {
        doc.outline.onChange(ed.selection.getNode());
    });
  }
});
</script>

<div id="tip_elements" style="display:none">
  <div id="tip_title">
      <div class="circle"><div class="circumscribed">1</div></div><div class="instruction">Title your document</div>
      <a onClick="doc.tipTour.showEditor();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_editor">
      <div class="circle"><div class="circumscribed">2</div></div><div class="instruction">Take notes here</div>
      <a onClick="doc.tipTour.showCards();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_cards">
      <div class="circle"><div class="circumscribed">3</div></div><div class="instruction">Cards will appear here when you use a dash like:<p>Zendo - meditation hall</p></div>
      <a onClick="doc.tipTour.showReview();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_review">
      <div class="circle"><div class="circumscribed">4</div></div><div class="instruction">Review here</div>
      <a onClick="doc.tipTour.restartTour();" href="javascript:void(0)">Restart</a>
  </div>
</div>