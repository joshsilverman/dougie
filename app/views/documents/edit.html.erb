<% @page_specific_scripts_js = ["parser"] %>

<div class="doc_options">
  <span>/<%= link_to @tag.name, '/#%i' % @tag.id %>/<input id="document_name" value="<%=@document.name%>"></input></span>
  <button id="review_button" style="float:right">Review</button>
  <button id="save_button" style="float:right;">Saved</button>
  <img id="sync_button" class="sync" src="/images/editor/sync-icon.png" alt=""/>
</div>

<div id="editor_container">
  <textarea id="editor" name="editor" style="display:none"><%=@document.html%></textarea>
</div>

<div id="right_rail" class="" style="display:none">
  <table class="align_bottom" valign="bottom"><tr><td id="cards" valign="bottom">
    <!--<div class="card card_active rounded_border"><input type="checkbox" class="card_activation" />truncated test</div>
    <div class="card_focus card rounded_border">
      <input type="checkbox" class="card_activation" />
      <div class="card_front">front</div>
      <div class="card_back">back and probablyaf sfkljasldk jfasldjfl;aksdjflsjdfsj flsjf lsk</div>
    </div>-->
  </td></tr></table>
</div>

<!-- document vars -->
<div id="document_id" style="display:none;"><%=@document.id%></div>
<div id="line_ids" style="display:none;"><%=@line_ids%></div>
<div id="new_doc" style="display:none;"><%=@new_doc%></div>

<%= javascript_include_tag ["vendors/tiny_mce/tiny_mce"], :cache => false %>
<script type="text/javascript">
tinyMCE.init({
  mode : "textareas",
  theme : "advanced",
  plugins : "emotions,spellchecker,advhr,insertdatetime,preview",

  // Theme options - button# indicated the row# only
  theme_advanced_buttons1 : "newdocument,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,fontselect,fontsizeselect,formatselect",
  theme_advanced_buttons2 : "cut,copy,paste,|,bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,image,|,preview,|,forecolor,backcolor",
  theme_advanced_buttons3 : "insertdate,inserttime,|,spellchecker,advhr,,removeformat,|,sub,sup,|,charmap,emotions",
  theme_advanced_toolbar_location : "top",
  theme_advanced_toolbar_align : "left",
  theme_advanced_resizing : true,

  onpageload : function() {doc.onEditorLoaded()},

  setup : function(ed) {
    ed.onKeyDown.add(function(ed, e) {
        doc.outline.onChange(ed.selection.getNode());
    });
  }
});
</script>